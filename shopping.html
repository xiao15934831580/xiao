<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/shopping.css"/>
		<link rel="stylesheet" type="text/css" href="font/iconfont.css"/>
	</head>
<body>
<!--header-->
<div class="header">
	<div class="headera">
		<img src="img/logo-footer.png"/>
		<p>我的购物车</p>
		<h4>温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算</h4>
		<div class="right">
			<h3 class="login_cookie">123456</h3>
			<h2>我的订单</h2>
		</div>
		
	</div>
</div>
<!--shop-->
<div class="goods">
	<table  class="tablea" width="1228px"  align="center" cellspacing="0" cellpadding="0">
		<tr align="center" class="tr">
			<th width="100px" height="70px">
				<input class="total" type="checkbox" />
				全选
			</th>
			<th width="490px">商品名称</th>
			<th width="160px">单价</th>
			<th width="212px">数量</th>
			<th width="132px">小计</th>
			<th width="140px">操作</th>
		</tr>
		<tr class="tr_a" align="center" height="180px">
			<td>
				<input class="check" type="checkbox" />
			</td>
			<td style="height: 86px;">
				<img src="img/note5-80-80.png" />
				<h2 class="erji"> 小米8 全网通版 6GB内存 64GB 黑色 </h2>
			</td>
			<td>
				<p><span>79</span>元</p>
			</td>
			<td>
				<button class="minus">-</button>
				<span class="nums">1</span>
				<button class="add">+</button>
			</td>
			<td>
				<p><span class="xiaoji">79</span>元</p>
			</td>
			<td>
				<span class="close">X</span>
			</td>
		</tr>
		
		<tr align="center">
			<td>
				<h2 class="cont"><a href="list.html">继续购物</a></h2>
			</td>
			<td>
				<p class="cont_p">共<span class="cont_pa">1</span>件商品，已选择<span class="cont-pb">1</span>件</p>
			</td>
			<td colspan="4">
				<p class="heji">合计：<span class="cent_tot">79</span>元</p>
				<h2 class="jiesuan">去结算</h2>
			</td>
		</tr>
	</table>
	
</div>
<div class="goods_list">
	<div class="products">
		<div class="goods_title">
			<fieldset class="other">
				<legend class="leglogin"> 买购物车中商品的人还买了</legend>
			</fieldset>
		</div>
		<div class="goods_down">
			<ul class="goods_downul">
				<li class="goods_img">
					<img width="233px" height="300px" src="img/yidong.jpg"/>
				</li>	
				<li class="goods_downli" datatype="12">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="13">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="14">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli"  datatype="15">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="16">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="17">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="18">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli"  datatype="19">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
				<li class="goods_downli" datatype="20">
					<img class="goods_downliimg" src="img/pms_1525853341.8312102_220x220.jpg" />
					<h2 ><a href="#"> 小米8 全网通版 6GB内存 128GB </a></h2>
					<span>2899元</span>
					<p class="goods_downlip">1.2万人好评 </p>
					<div class="down_hide">
						加入购物车
					</div>
				</li>
			</ul>
			
		</div>
	</div>
</div>

<!--footer-->
<div class="foot">
	<div class="foota">
		<div class="footup">
			<ul class="footup_ul">
				<li>
					<a href="#"><i class="iconfont icon-gongju"></i>预约维修服务</a>
				</li>
				<li>
					<a href="#"><i class="iconfont icon-gongju"></i>预约维修服务</a>
				</li>
				<li>
					<a href="#"><i class="iconfont icon-gongju"></i>预约维修服务</a>
				</li>
				<li>
					<a href="#"><i class="iconfont icon-gongju"></i>预约维修服务</a>
				</li>
				<li>
					<a href="#"><i class="iconfont icon-gongju"></i>预约维修服务</a>
				</li>
			</ul>
		</div>
		<div class="footdown">
			<div class="footdown_left">
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
				<ul class="footdown_leftul">
					<li class="help">帮助中心</li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
					<li><a href="#">帮助中心</a></li>
				</ul>
			</div>
			
			<div class="footdown_right">
				<h1>400-400-4004</h1>
				<h2>周一至周日 08:00-18:00</h2>
				<h2>仅收市话费</h2>
				<div class="footdown_rightp">
					<i class="iconfont icon-xiaoxi"></i>
					联系客服
				</div>
			</div>
		</div>
	</div>	
</div>

</body>
</html>
<script src="js/jquery-1.8.3.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
window.onload=function(){
	//登录后保存cookie
	function analysisCookie(item){//解析Cookie
	    var content=unescape(document.cookie);
	    var cookcon=content.split("; ");
	    for(var i in cookcon){
	       if(cookcon[i].indexOf(item+"=")==0){
	        return cookcon[i].substring(cookcon[i].indexOf("=")+1);
	       } 
	    }
	    return null;
	}
    // 页面打开后获取username显示在指定位置
	if(analysisCookie("username")!="null"){
		$(".login_cookie").html(analysisCookie("username"));
        // 获取该用户名的购物车内容并显示在购物车里面
		addcar(data);
    }


	function addcar(data){
        let total=0,HtmlStr='';
        $.each(){
            total=
            HtmlStr+="<tr class='' data=''>"
		}

	}
    function insertGood(data){
        let total=0,HtmlStr='';
        $.each(data, function (indexInArray, valueOfElement) {
            total=parseFloat(data[indexInArray].goodsPrice)*parseInt(data[indexInArray].goodsCount);
            HtmlStr+="<div class='good_info' data-gid='"+data[indexInArray].goodsId+"'><input type='checkbox' class='checkboxs'/>"+
                "<img src='"+data[indexInArray].goodsImg+"'/><div class='good_intro'><h4>"+data[indexInArray].goodsName+
                "</h4><p>"+data[indexInArray].goodsType+'  '+data[indexInArray].yanse+'  '+data[indexInArray].neicun+"</p></div>"+
                "<p class='good_price'>￥<span>"+data[indexInArray].goodsPrice+'.00'+"</span></p>"+
                "<div class='good_num'><input type='button' value='+' class='numAdd btn'/>"+
                "<input type='text' class='num' value='"+data[indexInArray].goodsCount+"'/>"+
                "<input type='button' value='-' class='numSub btn'/></div>"+
                "<p class='good_sum'>￥<span>"+total+".00"+"</span></p>"+
                "<div class='add' data-gid='"+data[indexInArray].goodsId+"'><i></i><i></i></div></div>";
        });
        $(".buyBytheway").after(HtmlStr);
        calcTotal();
        $(".loading").css("display","none");

    }
    $.ajax({
			type: "post",
            url: "http://localhost/xiaomi/goodsAndShoppingCart/getShoppingCart.php",
            data: "vipName="+$(".login_cookie").html(),
            dataType: "text",
			success: function (response) {
                console.log(response);
                if(response=="1"){
                        alert("加入购物车成功")
                        $(location).attr("href","shopping.html");          				
                }else{
                     alert("加入购物车失败")
                }
            }
    });


}
jQuery.fn.extend({
	guanlianCheck:function($child,$fanXuan){
		let $parent = this;
		//1、父控制子的选择
		//this：调用此函数的对象（jQuery对象），
		this.click(function(){
			let parent = this;//此this是事件源，是DOM对象
			$child.each(function(){
				//此this是$child里的每一个DOM元素；
				this.checked = parent.checked; 
			});
		});	
		
		//2、子控制父的选择
		$child.click(function(){
			let allCheck = true;
			//1）、循环所有的子chckbox，
			$child.each(function(){
				if(!this.checked){
					allCheck = false;
				}
			});
			//
			$parent[0].checked = allCheck;
		});
		//3、反选：
		$fanXuan&&$fanXuan.click(function(){
			$child.each(function(){
				this.checked = !this.checked;
			});
			let oldChecked = $child[0].checked;
			$child.first().trigger("click");
			$child[0].checked = oldChecked;
		});
	}
});

function total(){
	var str=$(".xiaoji");
	var num=0;
	for(var i=0;i<str.length;i++){
		var ab=Number(str[i].innerHTML);
		num+=ab;	
	}
	$(".cent_tot")[0].innerHTML=num;
}

$(function(){
	
	$(".total").guanlianCheck($(".check"),$(".dis"));
	$(".goods_downli").hover(function(){
		$(this).find(".down_hide").css("display","block");
	},function(){
		$(this).find(".down_hide").css("display","none");
	})
	$(".down_hide").hover(function(){
		$(this).css({
			"background-color":"#F15A2A",
			"color":"white"
		});
	})
	$(".add").click(function(){
		//数量
		$t=parseInt($(this).prev().html());
		$p=parseInt($(this).parent().prev().children().children().html());
		console.log($p);
		$t++;
		$(this).prev().html($t);
		$(this).parent().next().children().children().html($t*$p);
		total();
	})
	//点击减号
	$(".minus").click(function(){
		$n=parseInt($(this).next().html());
		$m=parseInt($(this).parent().prev().children().children().html());
		$n--;
		if($n<=1){
			$n=1;
		}
		$(this).next().html($n);
		$(this).parent().next().children().children().html($n*$m);	
		total();
	})
	$(".close").click(function(){
		$(this).parent().parent().remove();
		total();
	})
	
})

</script>